---
pagetitle: SEAsia
output: 
  html_document:
    toc: true
    toc_float: true
    toc_collapsed: true
    toc_depth: 1
    number_sections: true
    theme: cosmo
    #inverse: true
---

```{r setup, echo = FALSE}
source("thailand_data_functions.R")
source("thailand_aggregate_groups.R")
source("conversions.R")
knitr::opts_chunk$set(results = "hide", echo=FALSE, out.width = "75%", fig.align='center', message = F, warning = F, error = F, eval = T)
```



<!-- Allow href to tabsets --> 

```{js}
window.onload = function() {
  document.querySelector('a[href="' + window.location.href.match("#.*$") + '"]').click();
}

function goToTab() {
  var hash = String(window.location.href.match("#.*$"));
  var target = document.querySelector("a[role = 'tab'][href='" + hash + "']");
  if (target !== null) {
    var greatgrandparent = target.parentElement.parentElement.parentElement;
    if (greatgrandparent.getAttribute("role") == "tabpanel") {
      document.querySelector("a[role = 'tab'][href='#" + greatgrandparent.getAttribute("id") + "']").click();
    }
    target.click();
    target.scrollIntoView();
  }
}
window.onload = function() {
  setTimeout(goToTab, 100);
}
window.onhashchange = goToTab;
```


<!-- Set table styles -->

<style>
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}
</style>


<div class="header_logo">
<img src="images/logo_us_state_department.png" style="float:right;height:40px;">
<img src="images/logo_pnnl_white.png" style="float:right;height:40px;">
</div>


<!-------------------------->
<!-------------------------->
# Executive Summary
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

* **Motivation:** Growth in power demand, renewables, and changes in policies and resource availability will require significant evolution in grid planning. Current planning tools usually focus on near-term horizon (i.e., 5- to 10-year), and are inadequate to support long-term decisions about grid capacity and distribution infrastructure upgrades. Tools for integrated energy planning with both near-term and long-term time horizons could help MEA plan future activities. 
* **Objectives:** Energy sector development and modernization is required to support continued urbanization and socioeconomic growth while reducing environmental impact. The Pacific Northwest National Laboratory (PNNL) and Thammasat University will support Smart Grid planning for Bangkok by providing analysis and assessment of policy pathways using quantitative modeling approaches.
* **Approach:** Policy and technology trajectories will be modeled using the Global Change Analysis Model (GCAM), an integrated assessment model. GCAM will be used to conduct the detailed assessment of energy and electricity system transition over time in different policy and technology scenarios, and provide high-resolution information on power demand from buildings, transportation, and industry as well as power generation technologies. We will also examine how digitalization and smart technologies could change electricity load and implications for electricity generation. 
* **Expected Outcomes:** Outputs of GCAM will be used to 	inform MEA’s effort on grid moderation, especially for long-term holistic, integrated energy planning. Results will inform policy recommendations.

<br>

<!-------------------------->
<!-------------------------->
# Introduction & Motivation
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

Urbanization is driving rapid socioeconomic growth in Thailand, posing challenges for power grids as energy demand increases. Maintaining stability, reliability, and affordability of electricity will be especially challenging as Thailand works toward increasing their renewable energy (RE) shares and decreasing their environmental impact in line with international agreements. These goals and challenges were highlighted in Thailand’s 2018 Power Development Plan, which emphasized three priorities: energy security, economy, and environment. Energy security encompasses the need for stability of power generation, transmission, and distribution to support socioeconomic development and resilience to energy crises. Economic priorities are to promote low cost, high efficiency electricity generation, keeping prices low for consumers to further facilitate socioeconomic growth. Lastly, the plan emphasizes reducing environmental impact by supporting RE development and increasing efficiency in production and consumption.

```{r logos_diagram, results = "show", fig.cap="**Figure 2.1: Organizations involved in this analysis.**"}
knitr::include_graphics("images/logo_diagram.png")
```

The US-ASEAN Smart Cities Partnership (USASCP) uses innovative approaches across sectors to address the challenges and opportunities of energy development and urbanization in ASEAN Member States. The U.S. Department of Energy’s Pacific Northwest National Laboratory (PNNL) is partnering with Thammasat University and the Metropolitan Electricity Authority (MEA) of Thailand to supplement Bangkok’s existing Smart City roadmap plans by providing integrated modeling and assessment capabilities. PNNL’s Global Change Analysis Model (GCAM) is a global model integrating socioeconomics, energy, land use, water, and climate systems. PNNL, in collaboration with the Thammasat University modeling team, will use GCAM to assess the trajectories and outcomes of Smart City pathways for Bangkok and focus on the implications for the energy system in this analysis. The results of this analysis will aid MEA in their Smart City planning and implementation (Figure 2.1)


<br>

<!-------------------------->
<!-------------------------->
# Objectives
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

```{r purpose_diagram, results = "show", fig.cap="**Figure 3.1: Role of MEA's Smart Grid initiatives in Thailand's national power development goals.**"}
knitr::include_graphics("images/national_goals_smartGrid_diagram.png")
```

MEA supports energy sector plans for Bangkok by implementing Smart Grid development. The Smart Grid framework uses technological innovation to promote efficiency and reliability in power generation, transmission, and distribution systems while ensuring that the grid can both keep up with growing demand and accommodate RE expansion. Smart Grid approaches vary based on stakeholder needs but may include decentralizing generation, facilitating bidirectional data communication across the grid, integrating automation and monitoring, and providing opportunities for demand side management.

Thailand’s 2015 national Smart Grid master plan lays out plans to modernize its power sector through 2036 in line with the Smart Grid framework. In accordance with this national roadmap, MEA is developing Bangkok’s Smart Grid system by building capacity in the following areas:

* Monitoring and Control
* Data Analytics
* Supply Reliability
* Distributed Energy Resources Integration
* Green Energy
* Customer Engagement

Examples of planned technologies and policies include load forecasting, smart meter infrastructure, microgrids, energy storage systems, electric vehicle charging, and improved customer management systems, among others.

The collaboration between PNNL, Thammasat University, and MEA will support the long-term assessment of these plans and the analysis of their contribution to Thailand’s national socioeconomic growth, power development, and and environmental impact reduction goals (Figure 3.1). Based on results of the modeling approach detailed below, PNNL and Thammasat University will provide an analysis of pathways for grid modernization in Bangkok and possible trajectories towards a Bangkok Smart City in 2050.

<br>

<!-------------------------->
<!-------------------------->
# Approach
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

Integrated Assessment Models (IAMs) are computational models that use links and feedbacks between socioeconomic and environmental systems to assess the implications of technology and policy choices in the context of global climate change. IAMs can provide a holistic approach to energy sector planning by considering multi-sector dynamics and global processes. GCAM, an IAM developed at PNNL, incorporates socioeconomics, energy, land use, water, and climate system (Figure 4.1). The model is global but can also be used to assess specific regions and fine scale processes; PNNL has developed both Thailand and Bangkok regions within the model for national and city level analyses. GCAM utilizes the most up to date data on population, GDP, technology characteristics, policies, resource availabilities, and other inputs. It has the detailed representation of energy technologies in different sectors, including electricity, buildings, transportation, industry, hydrogen production, and other energy supply sectors. The model produces both historical and projected future outputs based on this information. These outputs include greenhouse gas emissions, electricity prices, energy supply and demand, and other indicators at five-year time steps from a historical baseline year to the desired end year. PNNL and Thammasat University's modeling team will use GCAM to assess the implications of MEA’s Smart Grid plans for Bangkok through the year 2100.

```{r GCAM_diagram, results = "show", fig.cap="**Figure 4.1: Conceptual diagram of GCAM.**"}
knitr::include_graphics("images/GCAM_diagram.png")
```


<br>


<!-------------------------->
<!-------------------------->
# Scenarios {.tabset}
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

PNNL, in consultation with Thammasat University and MEA, will develop a set of scenarios for GCAM modeling based on Thailand’s national energy policies and plans as well as MEA’s Smart Grid plans for Bangkok. The impacts of policies and technologies will be assessed in GCAM through associated changes to markets, efficiency assumptions, energy generation shares, and other multi-sector factors. GCAM will predict future outcomes under each scenario; these outcomes may include greenhouse gas emissions, energy supply and demand, market penetration of different technologies, electricity prices, and other relevant indicators of policy impacts. The scenarios will include the following:

* **National Policies:** Scenario integrating existing national energy development plans and energy and emissions reduction policies.
* **Extended National Policies:** Scenario additionally including extended sustainable development measures implemented in other countries.
* **Bangkok Smart Energy:** Scenario integrating MEA's plans for Bangkok grid modernization and digitalization along with national policies. 
* **Carbon Neutral Thailand:** Scenario using most efficient pathway to national carbon neutrality by 2050.
* **Net-Zero Thailand:** Scenario using most efficient pathway to net-zero national CO2 emissions by 2065

<!-------------------------->
## National Policies
<!-------------------------->

**National Policies Scenario:** This scenario integrates all of Thailand's national power development plans, as well as standards, regulations, and measures to promote energy efficiency, renewable energy expansion, and reduction of greenhouse gas emissions. These include the future power plant capacity changes reported in the Power Development Plan 2018-2037 (PDP2018) and the Renewable and Alternative Energy Development Plan 2018-2037 (AEDP2018). The scenario also incorporates the country’s planned energy conservation measures included the Energy Efficiency Plan 2018-2037 (EEP2018), the Transportation System Development Plan 2018-2037, and other policy documents. Policies and measures in this scenario span the power, transportation, buildings, and industry sectors. The table below summarizes the policies incorporated in the Mandatory National Policies scenario.

```{r national policy table, results = 'show'}
library(pander)
myTable = data.frame(
    Sector     = c("Energy Supply",
                  "Transportation",
                  "Buildings",
                  "Industry"),
    Policies = c("* Power Development Plan 2018-2037\
                 \n * Renewable and Alternative Energy Development Plan 2018-2037",
                 "* Vehicle emissions standards\
                 \n * Emissions-based excise tax structure",
                 "* Building Energy Codes enforcement",
                 "* Energy Efficiency Resource Standards")
    ) 
pander::pander(myTable, keep.line.breaks = TRUE, style = "grid", justify = 'left', split.tables=Inf, caption = "Table 5.1.1. Policies included in the National Policies scenario.")
```


<!-------------------------->
## Extended National Policies
<!-------------------------->

**Extended National Policies Scenario:** This scenario includes additional sustainable development measures that have been implemented in other countries and regions along vwith the plans and policies in the National Policies scenario. These include more aggresive power transitions, enhanced energy and emissions regulations, and economic incentives. The table below summarizes the additional policies incorporated in the Extended National Policies scenario. Note that this scenario also incorporates the national policies included in the Mandatory National Policies scenario.

```{r extended national policy table, results = 'show'}
library(pander)
myTable = data.frame(
    Sector     = c("Energy Supply",
                  "Transportation",
                  "Buildings & Industry"),
    Policies = c("* Power Development Plan 2018-2037 (bound capacity + target capacity)\
                 \n * Renewable and Alternative Energy Development Plan 2018-2037 (bound capacity + target capacity)",
                 "* Measures to promote EV use\
                 \n * Eco-driving promotion\
                 \n * Public transit expansion\
                 \n Electric Vehicle Roadmap to increase electric proportion of vehicles in manufacturing",
                 "* Voluntary energy efficiency labeling\
                 \n * Subsidies for equipment upgrades")
    ) 
pander::pander(myTable, keep.line.breaks = TRUE, style = "grid", justify = 'left', split.tables=Inf, caption = "Table 5.2.1. Policies included in the Extended National Policies scenario.")

```

<!-------------------------->
## Smart Energy
<!-------------------------->

**Bangkok Smart Energy Scenario:** This scenario incorporates the national-level policies included in the National Policies scenario as well as MEA’s grid modernization and digitalization plans for Bangkok. These plans include Smart Grid distribution system technologies, improved data management, and integration of microgrids and energy storage systems into the grid. Also included are transport sector plans, including EV charging system development, as well as measures for energy management and demand response in other sectors. The table below summarizes several components of MEA’s grid modernization and digitalization plans, along with the capabilities of GCAM integrated assessment modeling for each component.

```{r smart energy table, results = 'show'}
library(pander)
myTable = data.frame(
    'Sector'     = c("Monitoring & Control",
                  "Data Analytics",
                  "Supply Reliability",
                  "DER Integration",
                  "Green Energy",
                  "Customer Engagement"),
    'Policies & Technologies' = c("* Network analysis and load forecasting\
                 \n * Increased transmission control\
                 \n * Communication systems for identifying and addressing faults",
                 "* Advanced Metering Infrastructure\
                 \n * Outage management & data communication technology\
                 \n * Smart Energy Data Analytics Center",
                 "* Support increasing electricity demand & fully cover service area",
                 "* Microgrid system\
                 \n * Energy storage system\
                 \n * Building & Factory Energy Management Systems",
                 "* Electricity purchase from waste-to-energy plants\
                 \n * Household solar & community power plant project\
                 \n * EV promotion & smart charging",
                 "* Customer management systems & information access"),
    'GCAM Capabilities' = c("* Access long-term impacts of increased transmisison efficiency on the energy sector",
                "* Analyze how advanced metering can affect electricity demand & load management",
                "* Examine changes in future electricity demand in response to policy & technology changes",
                "* Project RE shares under microgrid & energy storage scenarios\
                \n * Assess how energy management systems will impact energy use by each sector",
                "* Assess how contributions from green energy sources impact generation mix in the long-term\
                \n * Reveal impacts of EV initiatives on transport sector and emissions",
                "* Integrate demand response impacts into energy conservation planning"), 
    check.names = FALSE
    ) 
pander::pander(myTable, keep.line.breaks = TRUE, style = "grid", justify = 'left', split.tables=Inf, caption = "Table 5.3.1. Policies and technologies included in the Bangkok Smart Energy scenario.")

```

<!-------------------------->
## Carbon Neutral and Net Zero
<!-------------------------->

**Net Zero and Carbon Neutral Thailand Scenarios:** At the 2021 United Nations climate change conference (COP26), Thailand’s prime minister announced the country’s goal to reach carbon neutrality by 2050 and net zero CO2 emissions by 2065. The carbon neutrality and net zero Thailand scenario represents the most economically efficient pathways for Thailand to reach carbon neutrality by 2050 and net zero CO2 emissions by 2065 given the energy policies included in the extended national policies scenario. This pathway will be found using GCAM’s solving capabilities. The outcomes of this scenario will provide insight into the role that the Bangkok metropolitan area will need play in Thailand’s decarbonization and highlight additional measures that may be needed.

<br>

<!-------------------------->
<!-------------------------->
# Scope {.tabset}
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

<!-------------------------->
## Spatial
<!-------------------------->

```{r scope map, results = "show", out.extra='style="float:right; padding:10px"', out.width="50%"}
knitr::include_graphics("images/MEA_BMA_boundaries_map.png")
```

PNNL’s assessment will encompass outcomes both on the national level and the city level, with the city level analysis including the three provinces served by MEA within the Bangkok metropolitan area. The map to the right shows these provinces (Figure 6.1.1): the green region includes Bangkok as well as the two other provinces served by MEA (Nonthaburi and Samut Prakan), while the shaded region includes only Bangkok itself, which is the area governed under the Bangkok Metropolitan Administration (BMA). For the city level analysis, results will be reported for each province individually as well as for the aggregated MEA service area.

```{r, fig.cap="**Figure 6.1.1. Map of analysis regions**", fig.align="right", results="show"}
knitr::include_graphics("images/half_blank_space.jpg")
```

<br>

<!-------------------------->
## Temporal
<!-------------------------->

Scenarios will be assessed up from the year 2015 to the year 2100, with the GCAM analysis conducted at five-year intervals within this range.


<p align="center"> <img src="images/blank_space.jpg"></p>

<br>

<!-------------------------->
<!-------------------------->
# Expected Outcomes {.tabset}
<!-------------------------->
<!-------------------------->

<p align="center"> <img src="images/divider.png"></p>

As illustrated above, GCAM will offer capacity for planning and decision-making in addition to MEA’s current capabilities. Benefits of GCAM and the integrated modeling approach include the following:

* **Climate change context:** Since GCAM integrates water and climate systems, it will provide a more nuanced analysis of Smart Grid pathways in the context of ongoing climate change. GCAM considers the bi-directional relationship between climate and energy: climate change impacts electricity demand and power system stability and reliability, while power generation contributes to climate change.
* **Long-term assessment:** GCAM will offer long-term projections of the impacts of Smart Grid technologies and policies, beyond the time frame already proposed in Thailand’s Smart Grid plan.
* **Technology analysis:** Using GCAM’s technology scenario capabilities, PNNL will be able to assess the impacts of specific technology implementations on electricity demand, generation, emissions, and prices far into the future.
* **Holistic approach:** GCAM analyzes the multi-sector impacts of policies and technologies, supporting the integration of MEA's Smart Grid development into the Smart City initiative. GCAM's holistic approach will provide insight into how MEA's Smart Grid plans fit within Thailand's broader goals for socioeconomic development and reduction of environmental impact.

These capabilities will enrich MEA's current capacity for grid planning and analyzing Smart City pathways.

<!-------------------------->
## Key Indicators
<!-------------------------->

The GCAM output for each scenario will include the following indicators calculated at 5-year timesteps through the year 2100 in the study region, as specified in the Spatial and Temporal Scope section.

```{r outputs table, results = 'show'}
library(pander)
myTable = data.frame(
    Indicator = c("Electricity generation", 
                  "Installed power capacity",
                  "Energy demand",
                  "Final energy consumption",
                  "CO2 emissions",
                  "Electricity price",
                  "Transport service output"),
    Description = c("Amount of electricity generated (total & by generation technology",
                    "Power capacity of power plants (total & by generation technology",
                    "Amount of energy demanded (total & by sector",
                    "Amount of energy consumed (total & by sector",
                    "Amount of CO2 emitted (total & by sector",
                    "Price of electricity for consumer by sector",
                    "Output of each type of transportation"),
    Units = c("terawatt-hours (TWh)",
              "TWh",
              "Exajoules (EJ)",
              "EJ",
              "metric tons CO2 equivalent (MT CO2)",
              "US dollars ($USD)",
              "passenger-kilometers (pass-km)")
    ) 
pander::pander(myTable, keep.line.breaks = TRUE, style = "grid", justify = 'left', split.tables=Inf, caption = "Table 7.1.1. Key indicators reported for each scenario.")

```

<!-------------------------->
## Model Results
<!-------------------------->

PNNL and Thammasat University will present GCAM results showing relevant outcomes of the modeled scenarios up to the year 2100. These results could include greenhouse gas emissions, energy supply and demand, electricity price, and technology penetration, among other indicators. PNNL will work with MEA to determine which indicators are the most important to consider when assessing the impact of Smart Grid policies and technologies. 

<!-------------------------->
## Analysis and Recommendations
<!-------------------------->

PNNL, in collaboration with Thammasat University and MEA, will summarize and interpret the GCAM results for each policy pathway and impact indicator. This will include a discussion of how these results relate to MEA’s smart grid efforts and Bangkok’s current Smart City roadmaps and potential additional roadmaps. Based on the GCAM results, PNNL and Thammasat University will provide recommendations for policy pathways that best meet the goals of MEA’s Smart Grid development while making the desired contributions to Thailand’s holistic Smart City and power development objectives. The process of analysis and recommendations will involve engagement and feedback from MEA in order to provide information that best addresses MEA’s planning needs. Final results will be summarized in both a report and a peer-reviewed paper.


<br>



<!-------------------------->
<!-------------------------->
# Timeline
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

Below is the proposed timeline for GCAM analysis, reports, and stakeholder engagement. 

```{r timeline, results = "show", out.width="100%", fig.cap="**Figure 8.1: Proposed timeline.**"}
knitr::include_graphics("images/timeline2.png")
```



<!-------------------------->
<!-------------------------->
# Inputs {.tabset}
<!-------------------------->
<!-------------------------->

<!-------------------------->
## Socioeconomics  {.tabset .tabset-pills}
<!-------------------------->

This section describes the socioeconomic (population and GDP) inputs used to define Thailand's subregions (Bangkok, Nonthaburi, Samut Prakan, and Rest of Thailand) in GCAM. Historical data and future projections were available were available at the national and regional scales for some time periods; however, we calculated socioeconomic data for the remaining time periods using the set of simplifying assumptions shown below. 

<table>

<tr>
<th>Variable</th>
<th style="width:40%">Assumptions</th>
<th style="width:50%">Data Sources</th>
</tr>

<tr>
<td>Population</td>
<td>Pre-2010 and post-2019 population growth rates are consistent between all regions</td>
<td>
<span>- All regions 2010-2019: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/01.aspx)</span><br/>
<span>- Pre-2010 & post-2020 growth rates: [United Nations](https://population.un.org/wpp/Graphs/1_Demographic%20Profiles/Thailand.pdf)</span>
</td>
</tr>


<tr>
<td rowspan="3">GDP</td>
<td>Pre-2011 and post-2020 GDP growth rates are consistent between all regions</td>
<td rowspan="2"> 
<span>- All regions 2011-2020: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/10.aspx)</span> <br/>
<span>- Pre-2011 growth rates:[World Bank](https://data.worldbank.org/indicator/NY.GDP.MKTP.CD?locations=TH)</span><br/>
<span>- 2021-2037 growth rates: [PDP2018](https://www.thaienergy.org/assets/files/pdp2018-pdf.pdf)</span><br/>
<span>- USD-THB exchange rates: [FRED](https://fred.stlouisfed.org/series/DEXTHUS#0)</span>
</td>
</tr>

<tr>
<td>Post-2037 GDP growth rate is constant</td>
</tr>

</table>

<br>
<br>

### Population


#### Recent Trends {-}

Thailand's National Statistical Office (NSO) has reported annual population both nationally and by province for the period from 2011 to 2020. The plot below shows national population, revealing a consistent increasing trend from 2011 to 2019, followed by a slight population decline from 2019 to 2020.

```{r recent national trends pop, fig.dim=c(8,4), fig.cap="**Figure 9.1.1.1 Thailand National Population from 2011 to 2020. Source: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/01.aspx)**"}
pop_inputs <- read.csv("../data/Thailand/socioeconomic_inputs/thailand_bangkok_nonthaburi_samutprakan_pop.csv")
pop_inputs$region <- factor(pop_inputs$region, levels = c("Thailand", "Bangkok", "Samut Prakan", "Nonthaburi", "Rest of Thailand"),
                            labels = c("Thailand", "Bangkok", "Samut Prakan", "Nonthaburi", "Rest of Thailand"))

pop_recent_chart_national <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(pop_inputs, 
                  year >= 2011, year <= 2020,
                  region == "Thailand"),
      value = value/1000000),
  save = F, aspect_ratio = 0.5)

pop_recent_chart_national$chart_param +
    ggplot2::ylab("Population (millions)") +
    ggplot2::theme(legend.position = "none",
                   strip.text = ggplot2::element_blank(),
                   plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br>
<br>

```{r recent MEA province trends pop, fig.align="right", out.extra='style="float:right; padding:10px"'}
pop_recent_chart_mea <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(pop_inputs, 
                  year >= 2011, year <= 2020,
                  !(region %in% c("Thailand", "Rest of Thailand"))), 
      value = value/1000000),
  save = F, aspect_ratio = 0.4)

pop_recent_chart_mea$chart_region_absolute +
    ggplot2::facet_wrap(~region, nrow = 3,
                        scales = "free_y", strip.position = "right") +
    ggplot2::ylab("Population (millions)") +
    ggplot2::theme(legend.position = "none",
                   plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

Of the three provinces in MEA's service area (Bangkok, Nonthaburi, and Samut Prakan), Bangkok has the highest population, followed by Samut Prakan and Nonthaburi. The population of Bangkok stayed relatively consistent between 2011 and 2019 but decreased in 2020. In the other two provinces, population increased consistently from 2011 to 2020, reaching approximately 1.35 million and 1.28 million in 2020 in Samut Prakan and Nonthaburi, respectively.


```{r, fig.cap="**Figure 9.1.1.2. Population from 2011 to 2020 in the MEA service area. Source: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/01.aspx)**", fig.align="right", results="show"}
knitr::include_graphics("images/half_blank_space.jpg")
```

<br>
<br>

#### Historical Trends and Future Projections {-}

To estimate pre-2011 historical population and projected future population for Thailand and the three MEA provinces, we applied population growth rates derived from the UN Thailand Demographic Profile to the NSO data. We made the simplifying assumption that historical and future population growth rates for each MEA province would be consistent with the national growth rates. The following plots show the estimated population from 1970 to 2100 for each region. Values within the shaded regions were reported by NSO, while all other values were estimated using the method described above.

```{r historical & future trends pop, fig.dim=c(8,4), fig.cap="**Figure 9.1.1.3. Historical and projected future population in Thailand and MEA area. Sources: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/01.aspx)(2011-2020) and [United Nations](https://population.un.org/wpp/Graphs/1_Demographic%20Profiles/Thailand.pdf) (Pre-2011 and post-2020)**"}
pop_all <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(pop_inputs, region != "Rest of Thailand"),
    value = value/1000000),
  save = F, aspect_ratio = 0.4
)


pop_all$chart_region_absolute +
  # 42 to 52 for non-numeric
  # 2011 to 2020 for numeric
    ggplot2::annotate("rect", xmin=2011, xmax=2020, ymin=-Inf, ymax=Inf,
                       alpha = 0.2, color = NA) +
    ggplot2::facet_wrap(~region, nrow = 2, 
                        scales = "free_y") +
    ggplot2::ylab("Population (millions)") +
    ggplot2::theme(legend.position = "none",
                   plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

<br>
<br>


<!-------------------------->
<!-------------------------->
### GDP (THB)
<!-------------------------->
<!-------------------------->

The plots below show GDP in units of Thai Baht at current prices for each year. See <a href=thailand_appendix.html> appendix </a> for plots showing GDP and per capita GDP at constant prices (2005 $USD), which is how GDP is input to GCAM.

#### Recent Trends {-}

Thailand's National Statistical Office (NSO) has reported annual GDP both nationally and by province for the period from 2010 to 2019. The plots below shows national GDP and GDP growth rate during this period.

```{r recent national trends gdp, fig.dim=c(9,4), fig.cap="**Figure 9.1.2.1. Thailand national GDP and GDP growth rate from 2010 to 2019. Source: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/10.aspx)**"}
gdp_inputs_baht <- read.csv("../data/Thailand/socioeconomic_inputs/baht_thailand_bangkok_nonthaburi_samutprakan_gdp.csv")
gdp_growth_baht <- read.csv("../data/Thailand/socioeconomic_inputs/baht_gdp_growth.csv")
gdp_inputs_baht$region <- factor(gdp_inputs_baht$region, 
                            levels = c("Thailand", "Bangkok", "Samut Prakan",
                                       "Nonthaburi", "Rest of Thailand"))

# plot gdp
gdp_recent_chart_national_baht <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(gdp_inputs_baht, 
                  year >= 2010, year <= 2019,
                  region == "Thailand"),
      value = value/1000000),
  save = F, aspect_ratio = 0.75)

p1 <- gdp_recent_chart_national_baht$chart_param +
    ggplot2::ylab("GDP (Trillions Baht)") +
    ggplot2::theme(legend.position = "none",
                   strip.text = ggplot2::element_blank(),
                   axis.title.y = ggplot2::element_text(size = 12),
                   plot.margin = ggplot2::unit(c(0,1,0,1), "cm"))

# plot gdp growth
gdp_growth_recent_chart_national_baht <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(gdp_growth_baht, 
                  year >= 2011, year <= 2019,
                  region == "Thailand")),
  save = F, aspect_ratio = 0.75)

p2 <- gdp_growth_recent_chart_national_baht$chart_param +
  ggplot2::ylab("GDP Growth Rate (%)") +
  ggplot2::theme(legend.position = "none",
                 strip.text = ggplot2::element_blank(),
                 axis.title.y = ggplot2::element_text(size = 12),
                 plot.margin = ggplot2::unit(c(0,1,0,1), "cm"))

ggpubr::ggarrange(p1, p2, nrow = 1) +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br>
<br>

```{r recent MEA province trends gdp baht, out.width="70%", out.extra='style="float:right; padding:10px"'}

# plot gdp
gdp_recent_chart_mea_baht <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(gdp_inputs_baht, 
                  year >= 2010, year <= 2019,
                  !(region %in% c("Thailand", "Rest of Thailand"))), 
      value = value/1000000),
  save = F, aspect_ratio = 0.4)

gdp_recent_chart_mea_baht$chart_region_absolute +
    ggplot2::facet_wrap(~region, nrow = 3,
                        scales = "free_y", strip.position = "right") +
    ggplot2::ylab("GDP (Trillions Baht)") +
    ggplot2::theme(legend.position = "none",
                   plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

Of the three MEA provinces, Bangkok had the highest GDP in 2019, reaching over 6 billion Baht. Samut Prakan had the next highest GDP of just over 770 million Baht, while Nonthaburi's GDP was nearly 350 million Baht. All three provinces experienced relatively consistent GDP growth in the period from 2010 to 2019.

```{r, fig.cap="**Figure 9.1.2.2. GDP from 2010 to 2019 in the MEA service area. Source: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/10.aspx)**", fig.align="right", results="show"}
knitr::include_graphics("images/half_blank_space.jpg")
```

<br>
<br>

The plot below shows the GDP growth rates of all three provinces during the same period.

```{r recent MEA province growth gdp baht, fig.dim=c(8,4), fig.cap="Figure 9.1.2.3. **GDP growth rate in the MEA service area from 2010 to 2019. Source: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/10.aspx)**"}
# plot gdp growth
gdp_growth_recent_chart_mea_baht <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(gdp_growth_baht, 
                  year >= 2011, year <= 2019,
                  region %in% c("Bangkok", "Nonthaburi", "Samut Prakan"))),
  save = F, aspect_ratio = 0.5)

gdp_growth_recent_chart_mea_baht$chart_region_absolute +
  ggplot2::ylab("GDP Growth Rate (%)") +
  ggplot2::theme(strip.text = ggplot2::element_blank()) +
  ggplot2::theme(strip.text.y = ggplot2::element_blank(),
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

<br>
<br>

#### Historical Trends and Future Projections {-}

To estimate pre-2011 historical GDP Thailand and the three MEA provinces, we applied GDP growth rates derived from historical World Bank Thailand national data to the NSO data. To project future GDP, we used the annual projected GDP growth rates from 2020 to 2037 reported in Thailand's 2018 Power Development Plan, and kept the growth rate constant at the 2037 rate (3.6) from 2037 to 2100. As with population, we assumed that historical and future GDP growth rates for each MEA province would be consistent with the national growth rates. The plot below shows the GDP growth rates for the entire period, 1970 to 2100.

```{r historical & future growth gdp baht, fig.dim=c(8,4), fig.cap="**Figure 9.1.2.4. Historical and projected future GDP growth rates in Thailand and MEA area. Sources: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/10.aspx) (2010-2019), [World Bank](https://data.worldbank.org/indicator/NY.GDP.MKTP.CD?locations=TH) (Pre-2010) and [PDP2018](https://www.thaienergy.org/assets/files/pdp2018-pdf.pdf) (Post-2020)**"}
# plot gdp growth
gdp_growth_chart_all_baht <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(gdp_growth_baht, 
                  region != "Rest of Thailand")),
  save = F, aspect_ratio = 0.5)

gdp_growth_chart_all_baht$chart_region_absolute +
  ggplot2::ylab("GDP Growth Rate (%)") +
  ggplot2::theme(strip.text = ggplot2::element_blank(),
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

<br>
<br>

The following plots show the estimated GDP from 1970 to 2100 for each region. Values within the shaded regions were reported by NSO, while all other values were estimated using the growth rates shown above.

```{r historical & future trends gdp baht, fig.dim=c(8,4), fig.cap="Figure 9.1.2.5. **Historical and projected future GDP in Thailand and MEA area. Sources: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/10.aspx) (2010-2019), [World Bank](https://data.worldbank.org/indicator/NY.GDP.MKTP.CD?locations=TH) (Pre-2010) and [PDP2018](https://www.thaienergy.org/assets/files/pdp2018-pdf.pdf) (Post-2020)**"}
# plot gdp
gdp_all_baht <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(gdp_inputs_baht, region != "Rest of Thailand"),
    value = value/1000000),
  save = F, aspect_ratio = 0.4
)

gdp_all_baht$chart_region_absolute +
  # 41 to 51 for non-numeric
  # 2010 to 2019 for numeric
    ggplot2::annotate("rect", xmin=2010, xmax=2019, ymin=-Inf, ymax=Inf,
                       alpha = 0.2, color = NA) +
    ggplot2::facet_wrap(~region, nrow = 2, 
                        scales = "free_y") +
    ggplot2::ylab("GDP (Trillions Baht)") +
    ggplot2::theme(legend.position = "none",
                   plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```



<!-------------------------->
<!-------------------------->
### Per Capita GDP (THB)
<!-------------------------->
<!-------------------------->

#### Recent Trends {-}

The plots below shows national per capita GDP during the recent period of 2011 to 2019.

```{r recent national trends pcgdp baht, fig.dim=c(8,4), fig.cap="Figure 9.1.3.1. **National per capita GDP from 2011 to 2019**"}
pcgdp_inputs_baht <- read.csv("../data/Thailand/socioeconomic_inputs/baht_thailand_bangkok_nonthaburi_samutprakan_pcgdp.csv")
pcgdp_inputs_baht$region <- factor(pcgdp_inputs_baht$region, 
                            levels = c("Thailand", "Bangkok", "Samut Prakan",
                                       "Nonthaburi", "Rest of Thailand"))

# plot gdp
pcgdp_recent_chart_national_baht <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(pcgdp_inputs_baht, 
                  year >= 2011, year <= 2019,
                  region == "Thailand"),
      value = value*1000),
  save = F, aspect_ratio = 0.5)

pcgdp_recent_chart_national_baht$chart_param +
    ggplot2::ylab("Per Capita GDP (Thousands Baht)") +
    ggplot2::theme(legend.position = "none",
                   strip.text = ggplot2::element_blank(),
                   plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))


```

<br>
<br>

```{r recent MEA province trends pcgdp baht, out.width="70%", out.extra='style="float:right; padding:10px"'}

# plot gdp
pcgdp_recent_chart_mea_baht <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(pcgdp_inputs_baht, 
                  year >= 2011, year <= 2019,
                  !(region %in% c("Thailand", "Rest of Thailand"))), 
      value = value*1000),
  save = F, aspect_ratio = 0.4)

pcgdp_recent_chart_mea_baht$chart_region_absolute +
    ggplot2::facet_wrap(~region, nrow = 3,
                        scales = "free_y", strip.position = "right") +
    ggplot2::ylab("Per Capita GDP (thousands Baht)") +
    ggplot2::theme(legend.position = "none",
                   plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```
These plots show per capita GDP in the three MEA provinces during the same period.

```{r, fig.cap="**Figure 9.1.3.2. GDP from 2010 to 2019 in the MEA service area. Source: [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/10.aspx)**", fig.align="right", results="show"}
knitr::include_graphics("images/half_blank_space.jpg")
```

<br>
<br>

#### Historical Trends and Future Projections {-}

The plot below shows per capita GDP from 1970 to 2100 for each region.

```{r historical & future trends pcgdp baht, fig.dim=c(8,4), fig.cap="**Figure 9.1.3.3. Per capita GDP through 2100 in each region**"}

# plot gdp
pcgdp_all_baht <- rchart::chart(
  dplyr::mutate(
    dplyr::filter(pcgdp_inputs_baht, region != "Rest of Thailand"),
    value = value),
  save = F, aspect_ratio = 0.4
)

pcgdp_all_baht$chart_region_absolute +
  # 42 to 51 for non-numeric
  # 2011 to 2019
    ggplot2::annotate("rect", xmin=2011, xmax=2019, ymin=-Inf, ymax=Inf,
                       alpha = 0.2, color = NA) +
    ggplot2::facet_wrap(~region, nrow = 2, 
                        scales = "free_y") +
    ggplot2::ylab("Per Capita GDP (Millions Baht)") +
    ggplot2::theme(legend.position = "none",
                   plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```



<!-------------------------->
<!-------------------------->
# GCAM Initial Diagnostics {.tabset}
<!-------------------------->
<!-------------------------->


<!-------------------------->
## Electricity {.tabset .tabset-pills}
<!-------------------------->


### National

```{r national electricity consumption data prep}
# read in local data
local_national_elec_consump <- read.csv(
  "../data/Thailand/scenario_outputs/initial_diagnostics/local_national_elec_consump.csv"
)

# read in and process gcam data
gcam_elec_consump_sector <- process_gcam_data(
  read.csv("../data/Thailand/scenario_outputs/initial_diagnostics/queryoutall_elec_consump_sector.csv", 
           skip = 1, check.names = F),
  processed = F, sector, input)

# aggregate gcam sectors
gcam_elec_consump_agg_sector <- dplyr::bind_rows(
  aggregate_rows(gcam_elec_consump_sector, class, "industry", industry_group),
  aggregate_rows(gcam_elec_consump_sector, class, "buildings", building_group),
  aggregate_rows(gcam_elec_consump_sector, class, "transport", transport_group)  
)

# aggregate local sectors
local_national_elec_consump_agg <- dplyr::bind_rows(
  aggregate_rows(local_national_elec_consump, class, "industry", industry_group_local),
  aggregate_rows(local_national_elec_consump, class, "buildings", building_group_local),
  aggregate_rows(local_national_elec_consump, class, "other", other_group_local)
)

# combine local and national data
all_elec_consump_sector_national <- dplyr::full_join(
  dplyr::ungroup(local_national_elec_consump_agg),
  dplyr::ungroup(gcam_elec_consump_agg_sector))

```

The figures below compare GCAM output with local data for national electricity consumption (total and by sector).

```{r national consumption total charts, fig.dim=c(8,4), fig.cap="**Figure 10.1.1.1. National electricity consumption from 2005 to 2100 (left) and 2011 to 2020 (right) from GCAM output (blue) and local utilities data (red). Local data source: [Energy Policy and Planning office](http://www.eppo.go.th/index.php/en/en-energystatistics/electricity-statistic)**"}

# 2010 to 2020 total elec consump
elec_consump_national_chart_local <- rchart::chart(
  dplyr::filter(all_elec_consump_sector_national, year <= 2020, year >= 2010),
  save = F)

p1 <- elec_consump_national_chart_local$chart_param_Thailand +
        ggplot2::theme(strip.text = ggplot2::element_blank(),
                       plot.margin = ggplot2::unit(c(0,0,1,0), "cm")) +
        ggplot2::ylab("") + ggplot2::ggtitle("") 


# 2000 to 2100 total elec consump
elec_consump_national_chart_gcam <- rchart::chart(
  dplyr::filter(all_elec_consump_sector_national, year >= 2000),
  save = F
)

p2 <- elec_consump_national_chart_gcam$chart_param_Thailand +
        ggplot2::ylab("Electricity Consumption (EJ)") +
        ggplot2::theme(strip.text = ggplot2::element_blank(),
                       plot.margin = ggplot2::unit(c(0,0,1,0), "cm"),
                       axis.title.y = ggplot2::element_text(size = 12)) +
        ggplot2::ggtitle("")


ggpubr::ggarrange(p2, p1, nrow = 1, common.legend = T, legend = "bottom") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br> 
<br>


```{r national consumption by sector 1, fig.dim=c(9,4), fig.cap="**Figure 10.1.1.2. National electricity consumption by sector in 2015 and 2020 from local utilities data (left) and GCAM output (right). Local data source: [Energy Policy and Planning office](http://www.eppo.go.th/index.php/en/en-energystatistics/electricity-statistic)**"}
# 2015, 2020 chart elec consump by sector
elec_consump_sector_national_chart_local <- rchart::chart(
  dplyr::filter(all_elec_consump_sector_national, year %in% c(2015,2020)),
  save = F)

elec_consump_sector_national_chart_local$chart_class_Thailand +
  ggplot2::ylab("Electricity Consumption (EJ)") +
  ggplot2::ggtitle("") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"),
                 axis.title.y = ggplot2::element_text(size = 12))
```

<br>
<br>

The figure below shows the long-term GCAM output for national electricity consumption.

```{r national consumption by sector 2, fig.dim=c(9,4), fig.cap="**Figure 10.1.1.3. GCAM output national electricity consumption by sector from 2010 to 2100**"}
#2000 to 2100 chart for elec consump by sector, just gcam
elec_consump_sector_national_chart_gcam <- rchart::chart(
  dplyr::filter(all_elec_consump_sector_national,
                year >= 2010, year <= 2100,
                scenario == "Ref"), save = F, aspect_ratio = 0.5)

elec_consump_sector_national_chart_gcam$chart_class_Thailand + 
  ggplot2::ylab("Electricity Consumption (EJ)") +
  ggplot2::ggtitle("") + 
  ggplot2::theme(strip.text = ggplot2::element_blank(),
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br>
<br>

<p align="center"> <img src="images/divider.png"></p>

### MEA service area

```{r total consumption MEA area data prep}
# read in local data
local_mea_elec_consump <- tidyr::drop_na(read.csv(
  "../data/Thailand/scenario_outputs/initial_diagnostics/local_mea_area_elec_consump.csv"
))

# aggregate local sectors
local_mea_elec_consump_agg <- dplyr::bind_rows(
  aggregate_rows(local_mea_elec_consump, class, "industry", industry_group_local),
  aggregate_rows(local_mea_elec_consump, class, "buildings", building_group_local),
  aggregate_rows(local_mea_elec_consump, class, "other", other_group_local)
)

# combine local and national data
all_elec_consump_sector_mea <- dplyr::full_join(
  local_mea_elec_consump_agg, gcam_elec_consump_agg_sector)

```

The figures below compare GCAM output with local data for electricity consumption in the MEA service area (total and by sector).

```{r consumption MEA area total charts, fig.dim=c(8,4), fig.cap="Figure 10.1.2.1. **Electricity consumption in the MEA service area from 2005 to 2100 (left) and 2011 to 2020 (right) from GCAM output (blue) and MEA data (red). Local data source: [Energy Policy and Planning office](http://www.eppo.go.th/index.php/en/en-energystatistics/electricity-statistic)**"}

# 2010 to 2020 total elec consump
elec_consump_mea_chart_local <- rchart::chart(
  dplyr::filter(all_elec_consump_sector_mea, year <= 2020, year >= 2010),
  save = F)

p1 <- elec_consump_mea_chart_local$`chart_param_MEA area` +
        ggplot2::theme(strip.text = ggplot2::element_blank(),
                       plot.margin = ggplot2::unit(c(0,0,1,0), "cm")) +
        ggplot2::ylab("") +
        ggplot2::ggtitle("") 


# 2000 to 2100 total elec consump
elec_consump_mea_chart_gcam <- rchart::chart(
  dplyr::filter(all_elec_consump_sector_mea, year >= 2000),
  save = F
)

p2 <- elec_consump_mea_chart_gcam$`chart_param_MEA area` +
        ggplot2::ylab("Electricity Consumption (EJ)") +
        ggplot2::theme(strip.text = ggplot2::element_blank(),
                       plot.margin = ggplot2::unit(c(0,0,1,0), "cm"),
                       axis.title.y = ggplot2::element_text(size = 12)) +
        ggplot2::ggtitle("")


ggpubr::ggarrange(p2, p1, nrow = 1, common.legend = T, legend = "bottom") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br>
<br>


```{r consumption by sector MEA area chart 1, fig.dim=c(9,4), fig.cap="**Figure 10.1.2.2. Electricity consumption by sector in the MEA service area from MEA data (left) and GCAM output (right) in 2015 and 2020. Local data source: [Energy Policy and Planning office](http://www.eppo.go.th/index.php/en/en-energystatistics/electricity-statistic)**"}

# chart of electricity consumption by sector (2010 to 2020)
elec_consump_sector_mea_chart_local <- rchart::chart(
  dplyr::filter(all_elec_consump_sector_mea, year %in% c(2015, 2020)),
  save = F)

elec_consump_sector_mea_chart_local$`chart_class_MEA area` +
  ggplot2::ylab("Electricity Consumption (EJ)") +
  ggplot2::ggtitle("")

```

<br>
<br>

The figure below shows the long-term GCAM output for electricity consumption by sector in the MEA service area.

``` {r consumption by sector MEA area chart 2, fig.dim=c(9,4), fig.cap="**Figure 10.1.2.3. GCAM output electricity consumption by sector in the MEA service area from 2010 to 2100**"}
# chart of electricity consumption by sector (gcam, 2000 to 2100)
elec_consump_sector_gcam_chart <- rchart::chart(dplyr::filter(
  all_elec_consump_sector_mea, scenario == "Ref", year >= 2010),
  save = F, aspect_ratio = 0.5)

elec_consump_sector_gcam_chart$`chart_class_MEA area` +
  ggplot2::ylab("Electricity Consumption (EJ)") +
  ggplot2::theme(strip.text = ggplot2::element_blank(),
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm")) +
  ggplot2::ggtitle("")


```

<br>
<br>

<p align="center"> <img src="images/divider.png"></p>

<!-------------------------->
## Energy {.tabset .tabset-pills}
<!-------------------------->


### National

```{r national final energy data prep}

######## by fuel ########

# read in and process gcam data
gcam_final_energy_fuel <- process_gcam_data(
  read.csv("../data/Thailand/scenario_outputs/initial_diagnostics/queryoutall_final_energy_consump_fuel_sector.csv", skip = 1, check.names = F),
  processed = F, input, sector
)


# read in local data
local_national_final_energy_fuel <- read.csv(
  "../data/Thailand/scenario_outputs/initial_diagnostics/local_national_final_energy_fuel.csv",
  check.names = F
)

# aggregate fuel types for local data
local_national_final_energy_fuel_agg <- dplyr::bind_rows(
  aggregate_rows(local_national_final_energy_fuel, class,
                 "electricity", electricity_group_local),
  aggregate_rows(local_national_final_energy_fuel, class,
                 "refined liquids", liquids_group_local),
  aggregate_rows(local_national_final_energy_fuel, class,
                 "gas", gas_group_local),
  aggregate_rows(local_national_final_energy_fuel, class,
                 "coal", coal_group_local)
)


# combine local and gcam data
all_national_final_energy_fuel <- dplyr::bind_rows(
  local_national_final_energy_fuel_agg, gcam_final_energy_fuel
)


######### by sector ##########
# read in and process gcam data
gcam_final_energy_sector <- process_gcam_data(
   read.csv("../data/Thailand/scenario_outputs/initial_diagnostics/queryoutall_final_energy_consump_fuel_sector.csv", skip = 1, check.names = F),
  processed = F, sector, input
)

# aggregate gcam sectors
gcam_final_energy_agg_sector <- dplyr::bind_rows(
  aggregate_rows(gcam_final_energy_sector, class, "industry", industry_group),
  aggregate_rows(gcam_final_energy_sector, class, "buildings", building_group),
  aggregate_rows(gcam_final_energy_sector, class, "transport", transport_group),
)

```

The figures below compare GCAM output with local data for national final energy consumption (total and by fuel type).

```{r national final energy total charts, fig.dim=c(8,4), fig.cap="Figure 10.2.1.1. **National total final energy from 1986 to 2100 (left) and 1986 to 2020 (right) from GCAM output (blue) and local data (red). Local data source: [Energy Policy and Planning Office](http://www.eppo.go.th/index.php/en/en-energystatistics/summary-statistic?orders[publishUp]=publishUp&issearch=1)**"}

# total final energy, 1986 to 2020
national_final_energy_chart_local <- rchart::chart(
  dplyr::filter(all_national_final_energy_fuel, year <= 2020),
  save = F
)

p1 <- national_final_energy_chart_local$chart_param_Thailand +
        ggplot2::ylab("") +
        ggplot2::theme(strip.text = ggplot2::element_blank(),
                       plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm")) +
        ggplot2::ggtitle("") 


# total final energy, 1986 to 2100
national_final_energy_chart_gcam <- rchart::chart(
  all_national_final_energy_fuel,
  save = F
)

p2 <- national_final_energy_chart_gcam$chart_param_Thailand +
      ggplot2::ylab("Energy (EJ)") +
      ggplot2::theme(strip.text = ggplot2::element_blank()) +
      ggplot2::ggtitle("") +
      ggplot2::scale_y_continuous(breaks = scales::pretty_breaks())

ggpubr::ggarrange(p2, p1, nrow = 1, common.legend = T, legend = "bottom", 
                  widths = c(1,0.975)) +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br>
<br>

```{r national final energy consumption by fuel 1, fig.dim=c(9,4), fig.cap="**Figure 10.2.1.2. National total final energy by fuel from local data (left) and GCAM output (right) from 2005 to 2020. Local data source: [Energy Policy and Planning Office](http://www.eppo.go.th/index.php/en/en-energystatistics/summary-statistic?orders[publishUp]=publishUp&issearch=1)**"}

# 2005 to 2020 final energy by fuel (gcam and local)
final_energy_fuel_chart_local <- rchart::chart(dplyr::filter(
  all_national_final_energy_fuel, year >= 2005, year <= 2020, year %% 5 == 0),
  save = F)

final_energy_fuel_chart_local$chart_class_Thailand +
  ggplot2::ggtitle("") + ggplot2::ylab("Energy (EJ)")
```

<br>
<br>

The figure below shows the long-term GCAM output for national final energy consumption by fuel.

``` {r national final energy consumption by fuel 2, fig.dim=c(9,4), fig.cap="**Figure 10.2.1.3. GCAM output national total final energy consumption by fuel from 2010 to 2100**"}
# 2005 to 2100 final energy by fuel (just gcam)
final_energy_fuel_chart_gcam <- rchart::chart(dplyr::filter(
  all_national_final_energy_fuel, year >= 2010, scenario == "Ref"),
  save = F, break_interval = 3, aspect_ratio = 0.5)

final_energy_fuel_chart_gcam$chart_class_Thailand +
  ggplot2::ggtitle("") + ggplot2::ylab("Energy (EJ)") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br>
<br>

We have not identified any local data regarding energy consumption by sector; the figure below shows GCAM output only.

```{r national final energy consumption by sector charts, fig.dim=c(9,4), fig.cap="**Figure 10.2.1.4. GCAM output national total final energy consumption by sector from 2010 to 2100**"}

# 2000 to 2100, gcam only (no local data available)
gcam_final_energy_agg_sector_chart <- rchart::chart(
  dplyr::filter(gcam_final_energy_agg_sector, year > 2010),
  save = F, aspect_ratio = 0.5
)

gcam_final_energy_agg_sector_chart$chart_class_Thailand +
  ggplot2::ggtitle("") + ggplot2::ylab("Energy (EJ)") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br>
<br>

<p align="center"> <img src="images/divider.png"></p>

### MEA service area

We have not identified any local data regarding energy consumption in the MEA service area. Below are some initial energy results from GCAM for the region.

```{r MEA energy consumption total, fig.dim = c(9,4), fig.cap="**Figure 10.2.2.1. GCAM output of total final energy consumption in the MEA service area**"}
gcam_final_energy_agg_sector_chart$`chart_param_MEA area` +
  ggplot2::ggtitle("") + ggplot2::ylab("Energy Consumption (EJ)")
  ggplot2::theme(legend.position = "none",
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br>
<br>

```{r MEA energy consumption by sector, fig.dim = c(9,4), fig.cap="**Figure 10.2.2.2. GCAM output of total final energy consumption by sector in the MEA service area**"}
gcam_final_energy_agg_sector_chart$`chart_class_MEA area`+
  ggplot2::ggtitle("") + ggplot2::ylab("Energy Consumption (EJ)") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

<br>
<br>

```{r MEA energy consumption by fuel, fig.dim = c(9,4), fig.cap="**Figure 10.2.2.3. GCAM output of total final energy consumption by fuel in the MEA service area**"}
final_energy_fuel_chart_gcam$`chart_class_MEA area`+
  ggplot2::ggtitle("") + ggplot2::ylab("Energy Consumption (EJ)") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

<br>
<br>

<p align="center"> <img src="images/divider.png"></p>

<!-------------------------->
## Emissions {.tabset .tabset-pills}
<!-------------------------->


### National

```{r national co2 emissions data prep}
C_to_CO2 <- 44/12

# read in and process gcam data
gcam_co2_emissions_sector <- dplyr::mutate(
  process_gcam_data(
  read.csv("../data/Thailand/scenario_outputs/initial_diagnostics/queryoutall_co2_emissions_sector.csv", skip = 1, check.names = F),
  processed = F, sector), value = value * C_to_CO2, Units = "MTCO2"
)

# aggregate gcam sectors
gcam_co2_emissions_agg_sector <- dplyr::bind_rows(
  aggregate_rows(gcam_co2_emissions_sector, class, "industry", industry_group),
  aggregate_rows(gcam_co2_emissions_sector, class, "buildings", building_group),
  aggregate_rows(gcam_co2_emissions_sector, class, "transportation", transport_group),
  aggregate_rows(gcam_co2_emissions_sector, class, "electricity", elec_group),
  aggregate_rows(gcam_co2_emissions_sector, class, "other", other_group)
)

# read in local data 
local_national_co2_emissions_sector <- dplyr::mutate(
  read.csv(
  "../data/Thailand/scenario_outputs/initial_diagnostics/local_national_co2_emissions_sector.csv",
  check.names = F)
)

# combine local and gcam data
all_national_co2_emissions_sector <- dplyr::bind_rows(
  gcam_co2_emissions_agg_sector, local_national_co2_emissions_sector
)
```

The figures below compare GCAM output with local data for national CO2 emissions (total and by sector).

```{r national co2 emissions total, fig.dim=c(8,4), fig.cap="**Figure 10.3.1.1. National total CO2 emissions from 1986 to 2100 (left) and 1986 to 2015 (right) from GCAM output (blue) and local data (red). Local data source: [Energy Policy and Planning Office](http://www.eppo.go.th/index.php/en/en-energystatistics/co2-statistic)**"}

# 1986 to 2015
national_co2_emissions_plot_local <- rchart::chart( dplyr::filter(
  all_national_co2_emissions_sector, year >= 1986, year <= 2015),
  save = F
)

p1 <- national_co2_emissions_plot_local$chart_param_Thailand +
  ggplot2::ylab("") + ggplot2::ggtitle("") +
  ggplot2::theme(strip.text = ggplot2::element_blank())


# 2000 to 2100
national_co2_emissions_plot_gcam <- rchart::chart(dplyr::filter(
  all_national_co2_emissions_sector, year >= 1986),
  save = F)

p2 <- national_co2_emissions_plot_gcam$chart_param_Thailand +
  ggplot2::ylab("CO2 emissions (MT)") + ggplot2::ggtitle("") +
  ggplot2::theme(strip.text = ggplot2::element_blank())

ggpubr::ggarrange(p2, p1, align = "h", common.legend = T, legend = "bottom") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))


```

<br>
<br>

```{r national co2 emissions by sector plots, fig.dim=c(9,4), fig.cap="**Figure 10.3.1.2. National total CO2 emissions by sector from local data (left) and GCAM output (right) from 2005 to 2015. Local data source: [Energy Policy and Planning Office](http://www.eppo.go.th/index.php/en/en-energystatistics/co2-statistic)**"}

# 2005 to 2015
national_co2_emissions_sector_plot_local <- rchart::chart( dplyr::filter(
  all_national_co2_emissions_sector, year >= 2005, year <= 2015, year %% 5 == 0),
  save = F
)

national_co2_emissions_sector_plot_local$chart_class_Thailand +
  ggplot2::ggtitle("") + ggplot2::ylab("CO2 Emissions (MT)") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

<br>
<br>

The figure below shows the long-term GCAM output for national CO2 emissions by sector.

```{r national co2 emissions by sector gcam, fig.dim = c(9,4), fig.cap="**Figure 10.3.1.3. GCAM output of national total CO2 emissions by sector through 2100**"}
# 2000 to 2100 (just gcam)
national_co2_emissions_sector_plot_gcam <- rchart::chart(dplyr::filter(
  all_national_co2_emissions_sector, year >= 2000, scenario == "Ref"),
  save = F)

national_co2_emissions_sector_plot_gcam$chart_class_Thailand +
  ggplot2::ggtitle("") + ggplot2::ylab("CO2 Emissions (MT)") +
  ggplot2::theme(strip.background = ggplot2::element_blank(),
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))


```

<br>
<br>

<p align="center"> <img src="images/divider.png"></p>

### MEA service area

We have not identified any local data concerning emissions in the MEA service area. Below are some initial emissions results from GCAM for the region.

```{r MEA co2 emissions total gcam, fig.dim = c(9,4), fig.cap="**Figure 10.3.2.1 GCAM output of total CO2 emissions in the MEA service area**"}
mea_co2_emissions_sector_plot_gcam <- rchart::chart(dplyr::filter(
  all_national_co2_emissions_sector, year >= 2000, scenario == "Ref"),
  save = F, aspect_ratio = 0.5)

mea_co2_emissions_sector_plot_gcam$`chart_param_MEA area` +
  ggplot2::ggtitle("") + ggplot2::ylab("CO2 Emissions (MT)") +
  ggplot2::theme(legend.position = "none",
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

<br>
<br>

```{r MEA co2 emissions sector gcam, fig.dim = c(9,4), fig.cap="**Figure 10.3.2.2. GCAM output of total CO2 emissions in the MEA service area**"}

mea_co2_emissions_sector_plot_gcam$`chart_class_MEA area` +
  ggplot2::ggtitle("") + ggplot2::ylab("CO2 Emissions (MT)") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```


<br>
<br>

<p align="center"> <img src="images/divider.png"></p>

<!-------------------------->
## Transportation {.tabset .tabset-pills}
<!-------------------------->

### National

```{r transportation data prep}
# read in local data
local_national_transport_output <- read.csv(
  "../data/Thailand/scenario_outputs/initial_diagnostics/local_national_transport_output.csv",
  check.names = F
)

local_national_transport_ghg <- read.csv(
  "../data/Thailand/scenario_outputs/initial_diagnostics/local_transport_ghg_emissions_mode.csv",
  check.names = F, skip = 1
)

# read in and process gcam data
gcam_transport_output_subsector <- process_gcam_data(
  read.csv("../data/Thailand/scenario_outputs/initial_diagnostics/queryoutall_transport_output_tech.csv", skip = 1, check.names = F),
  processed = F, subsector, sector, technology
)

gcam_ghg_subsector <- process_gcam_data(conv_ghg_co2e(process_gcam_data(
  read.csv("../data/Thailand/scenario_outputs/initial_diagnostics/queryoutall_non_co2_emissions_subsector.csv", skip = 1, check.names = F))),
  processed = T, subsector, sector, GHG)

# gcam_ghg_subsector_raw <- process_gcam_data(
#   read.csv("data/Thailand/outputs/initial_diagnostics/queryoutall_non_co2_emissions_subsector.csv", skip = 1, check.names = F),
#   processed = F, subsector, sector, GHG)

# aggregate GCAM data
gcam_transport_output_agg_subsector <- dplyr::bind_rows(
  aggregate_rows(gcam_transport_output_subsector, class, "road", road_group),
  aggregate_rows(gcam_transport_output_subsector, class, "rail", rail_group),
  aggregate_rows(gcam_transport_output_subsector, class, "ship", ship_group),
  aggregate_rows(gcam_transport_output_subsector, class, "air", air_group)
)

gcam_transport_ghg <- dplyr::bind_rows(
  aggregate_rows(gcam_ghg_subsector, class, "road", road_group),
  aggregate_rows(gcam_ghg_subsector, class, "rail", rail_group),
  aggregate_rows(gcam_ghg_subsector, class, "ship", ship_group),
  aggregate_rows(gcam_ghg_subsector, class, "air", air_group)
)

# gcam_transport_ghg_raw <- dplyr::bind_rows(
#   aggregate_rows(gcam_ghg_subsector_raw, class, "road", road_group),
#   aggregate_rows(gcam_ghg_subsector_raw, class, "rail", rail_group),
#   aggregate_rows(gcam_ghg_subsector_raw, class, "ship", ship_group),
#   aggregate_rows(gcam_ghg_subsector_raw, class, "air", air_group)
# )

# combine GCAM and local data
all_national_transport_sector <- dplyr::ungroup(    dplyr::bind_rows(gcam_transport_output_agg_subsector, local_national_transport_output))

all_transport_ghg <- dplyr::ungroup(dplyr::bind_rows(gcam_transport_ghg, local_national_transport_ghg))

```

The figures below compare GCAM output with local data for national greenhouse gas emissions in the transportation sector (total and by mode of transport).

```{r national transport ghg total, fig.dim = c(9,4), fig.cap="**Figure 10.4.1.1. National GHG emissions in transportation from GCAM output (blue) and local data (red). Local data source: [Ministry of Transport](https://datagov.mot.go.th/dataset/transport-ghg)**"}
transport_ghg_chart1 <- rchart::chart(dplyr::filter(
  all_transport_ghg, year >= 2000),
  save = F
  )

p1 <- transport_ghg_chart1$chart_param_Thailand +
  ggplot2::ylim(c(0, 350)) +
  ggplot2::ylab("GHG Emissions (MT CO2eq)") + ggplot2::ggtitle("") +
  ggplot2::theme(axis.title.y = ggplot2::element_text(size = 12))

transport_ghg_chart2 <- rchart::chart(dplyr::filter(
  all_transport_ghg, year >= 2000, year <= 2020),
  save = F
  )

p2 <- transport_ghg_chart2$chart_param_Thailand +
  ggplot2::ylim(c(0, 100)) +
  ggplot2::ylab("") + ggplot2::ggtitle("")

ggpubr::ggarrange(p1, p2, nrow = 1, common.legend = T, legend = "bottom") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))


```

<br>
<br>

```{r transport ghg by mode, fig.dim=c(9,4), fig.cap="**Figure 10.4.1.2. National GHG emissions by mode of transportation from local data (left) and GCAM output (right). Local data source: [Ministry of Transport](https://datagov.mot.go.th/dataset/)**"}
transport_ghg_sector_chart <- rchart::chart(dplyr::filter(
  all_transport_ghg, year %in% c(2005, 2010, 2015)),
  save = F)

transport_ghg_sector_chart$chart_class_Thailand +
  ggplot2::ggtitle("") + ggplot2::ylab("GHG Emissions (MT CO2eq)") +
  ggplot2::theme(axis.title.y = ggplot2::element_text(size = 12),
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

<br>
<br>

The figure below shows the long-term GCAM output for national greenhouse gas emissions by mode of transport.

```{r transport ghg by mode gcam, fig.dim=c(9,4), fig.cap="**Figure 10.4.1.3. GCAM output of national GHG emissions by mode of transportation through 2100**"}
transport_ghg_sector_chart2 <- rchart::chart(dplyr::filter(
  all_transport_ghg, year >= 2010, scenario == "Ref"), 
  save = F, aspect_ratio = 0.5)

transport_ghg_sector_chart2$chart_class_Thailand +
  ggplot2::ggtitle("") + ggplot2::ylab("GHG Emissions (MT CO2eq)") +
  ggplot2::theme(axis.title.y = ggplot2::element_text(size = 12),
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))

```

<br>
<br>

<p align="center"> <img src="images/divider.png"></p>

### MEA service area

We have not identified any local transportation data in the MEA service area. Below are some initial transportation results from GCAM for the region.

```{r total transportation ghg mea, fig.dim=c(9,4), fig.cap="**Figure 10.4.2.1. GCAM output of total GHG emissions from transportation in the MEA service area**"}
transport_ghg_sector_chart2$`chart_param_MEA area` +
  ggplot2::ggtitle("") + ggplot2::ylab("GHG Emissions (MT CO2eq)") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0),"cm")) +
  ggplot2::ylim(c(0,35))

```

<br>
<br>

```{r total transportation ghg mea mode, fig.dim=c(9,4), fig.cap="**Figure 10.4.2.2 GCAM output of GHG emissions by transportation mode in the MEA service area**"}
transport_ghg_sector_chart2$`chart_class_MEA area` +
  ggplot2::ggtitle("") + ggplot2::ylab("GHG Emissions (MT CO2eq)") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0),"cm")) 

```

<br>
<br>

<p align="center"> <img src="images/divider.png"></p>

<!-------------------------->
## Buildings {.tabset .tabset-pills}
<!-------------------------->

We have not identified local data regarding buildings energy consumption. Below are some initial GCAM outputs for the national and MEA service area regions.

```{r national buildings energy data prep}

# read in and process gcam data
gcam_buildings_final_energy_fuel <- process_gcam_data(
  read.csv("../data/Thailand/scenario_outputs/initial_diagnostics/queryoutall_building_final_energy_service_fuel.csv", skip = 1, check.names = F),
  processed = F, input, sector
)

gcam_buildings_final_energy_sector <- process_gcam_data(
  read.csv("../data/Thailand/scenario_outputs/initial_diagnostics/queryoutall_building_final_energy_service_fuel.csv", skip = 1, check.names = F),
  processed = F, sector, input
)

# aggregate gcam classes
gcam_buildings_final_energy_agg_sector <- dplyr::bind_rows(
  aggregate_rows(gcam_buildings_final_energy_sector, class, "commercial", comm_group),
  aggregate_rows(gcam_buildings_final_energy_sector, class, "residential", resid_group)
)

gcam_buildings_final_energy_agg_fuel <- dplyr::bind_rows(
  aggregate_rows(gcam_buildings_final_energy_fuel, class, "biomass", biomass_group),
  aggregate_rows(gcam_buildings_final_energy_fuel, class, "electricity", electricity_group),
  aggregate_rows(gcam_buildings_final_energy_fuel, class, "refined liquids", liquids_group),
  aggregate_rows(gcam_buildings_final_energy_fuel, class, "gas", gas_group)
)


```

```{r GCAM buildings energy total all regions, fig.dim=c(9,4), fig.cap="**Figure 10.5.1. GCAM output for buildings final energy consumption in all regions from 2005 to 2100**"}
gcam_buildings_energy_sector_chart <- rchart::chart(dplyr::filter(
  gcam_buildings_final_energy_sector, 
    region %in% c("MEA area", "Rest of Thailand", "Thailand"),
    year > 2000),
  save = F, aspect_ratio = 0.5)

gcam_buildings_energy_sector_chart$chart_region_absolute +
  ggplot2::ylab("Buildings Energy Consumption (EJ)") +
  ggplot2::theme(axis.title.y = ggplot2::element_text(size = 12),
                 plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```

<br>
<br>

```{r GCAM buildings energy consumption by sector, fig.dim=c(9,4), fig.cap="**Figure 10.5.2. GCAM output for buildings energy consumption by sector in the MEA service area (top) and the rest of Thailand (bottom)**"}


p1 <- gcam_buildings_energy_sector_chart$`chart_class_MEA area` +
  ggplot2::ylab("Buildings Energy Consumption (EJ)") +
  ggplot2::theme(axis.title.y = ggplot2::element_text(size = 12))

p2 <- gcam_buildings_energy_sector_chart$`chart_class_Rest of Thailand` +
  ggplot2::ylab("") 

ggpubr::ggarrange(p1, p2, common.legend = T, nrow = 1, legend = "bottom") +
  ggplot2::theme(plot.margin = ggplot2::unit(c(0,0,0.5,0), "cm"))
```


<br>
<br>

<p align="center"> <img src="images/divider.png"></p>

<!-------------------------->
<!-------------------------->
# References {.tabset}
<!-------------------------->
<!-------------------------->

<!-------------------------->
## Local Data
<!-------------------------->

### Socioeconomics {-}
* Historical Population (2011-2020): [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/01.aspx)
* Historical Population (1970-2019) and population projection: [United Nations](https://population.un.org/wpp/Graphs/1_Demographic%20Profiles/Thailand.pdf)
* Historical GDP (2010-2019): [National Statistical Office](http://statbbi.nso.go.th/staticreport/page/sector/en/10.aspx)

### Electricity {-}
* Electricity consumption: [Energy Policy and Planning Office](http://www.eppo.go.th/index.php/en/en-energystatistics/electricity-statistic)

### Energy {-}
* Energy consumption: [Energy Policy and Planning Office](http://www.eppo.go.th/index.php/en/en-energystatistics/summary-statistic?orders[publishUp]=publishUp&issearch=1)

### Emissions {-}
* CO2 emissions: [Energy Policy and Planning Office](http://www.eppo.go.th/index.php/en/en-energystatistics/co2-statistic)

### Transportation {-}
* GHG emissions: [Ministry of Transport](https://datagov.mot.go.th/dataset/transport-ghg)

<br>

<p align="center"> <img src="images/divider.png"></p>

<!-------------------------->
<!-------------------------->
# Appendix
<!-------------------------->
<!-------------------------->

See <a href = "thailand_appendix.html"> Appendix </a> for supplementary information.

